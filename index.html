<!doctype html>
<html lang="th" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>File Notice</title>
  <script src="https://cdn.tailwindcss.com/3.4.17"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600;700&family=Prompt:wght@300;400;500;600&display=swap" rel="stylesheet">
  <style>
    * { font-family: 'Kanit', 'Prompt', sans-serif; }
    @keyframes float { 0%, 100% { transform: translateY(0px); } 50% { transform: translateY(-10px); } }
    @keyframes pulse-glow { 0%, 100% { box-shadow: 0 0 20px rgba(147, 51, 234, 0.4); } 50% { box-shadow: 0 0 40px rgba(147, 51, 234, 0.8); } }
    @keyframes shimmer { 0% { background-position: -200% center; } 100% { background-position: 200% center; } }
    @keyframes spin-slow { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
    .float-animation { animation: float 3s ease-in-out infinite; }
    .pulse-glow { animation: pulse-glow 2s ease-in-out infinite; }
    .shimmer-text {
      background: linear-gradient(90deg, #a855f7, #ec4899, #f97316, #ec4899, #a855f7);
      background-size: 200% auto; -webkit-background-clip: text; background-clip: text;
      -webkit-text-fill-color: transparent; animation: shimmer 3s linear infinite;
    }
    .gradient-border { position: relative; background: linear-gradient(135deg, #1e1b4b 0%, #312e81 50%, #1e1b4b 100%); border-radius: 24px; }
    .gradient-border::before {
      content: ''; position: absolute; inset: -3px;
      background: linear-gradient(45deg, #a855f7, #ec4899, #f97316, #eab308, #a855f7);
      border-radius: 27px; z-index: -1; animation: spin-slow 4s linear infinite;
    }
    .glass-card { background: rgba(30, 27, 75, 0.8); backdrop-filter: blur(20px); border: 1px solid rgba(168, 85, 247, 0.3); }
    .countdown-ring { stroke-dasharray: 283; stroke-dashoffset: 0; transition: stroke-dashoffset 1s linear; }
    .btn-ready { background: linear-gradient(135deg, #a855f7, #ec4899); transform: scale(1.05); }
  </style>
 </head>
 <body class="h-full overflow-auto bg-gradient-to-br from-slate-900 via-purple-950 to-slate-900">
  <div class="min-h-full w-full relative">
   <div class="fixed inset-0 overflow-hidden pointer-events-none">
    <div class="absolute top-20 left-10 w-72 h-72 bg-purple-500/20 rounded-full blur-3xl"></div>
    <div class="absolute bottom-20 right-10 w-96 h-96 bg-pink-500/20 rounded-full blur-3xl"></div>
   </div>

   <div class="relative z-10 flex flex-col items-center justify-center min-h-full px-4 py-8">
    
    <div class="flex items-center justify-center gap-4 mb-8 float-animation">
      <div class="w-16 h-16 md:w-20 md:h-20 rounded-2xl bg-white/10 overflow-hidden flex items-center justify-center border border-white/20 shadow-lg shadow-purple-500/30">
        <img src="https://scontent.fkkc3-1.fna.fbcdn.net/v/t39.30808-6/642768993_1941877609748834_2263063250765183521_n.jpg?_nc_cat=109&ccb=1-7&_nc_sid=7b2446&_nc_ohc=zYEj8N644KoQ7kNvwEWGI3a&_nc_oc=AdmlInMB5nE7eKoeYcbVBZaQ8dVC1YR60Q8sOgkh55L_2S0eUirMN-JvpRFp-D5Pp0s&_nc_zt=23&_nc_ht=scontent.fkkc3-1.fna&_nc_gid=nSWK6SUvzqaOygk2vcSyzQ&_nc_ss=8&oh=00_AfuxbGpyiELl2bLdxejMOTJnvQOjgOwOvkE9nC1pdqyBsw&oe=69A8656B" alt="Logo 1" class="w-full h-full object-cover">
      </div>
      <div class="w-20 h-20 md:w-24 md:h-24 rounded-full bg-white/10 overflow-hidden flex items-center justify-center border-2 border-pink-500 shadow-xl shadow-pink-500/40 pulse-glow">
        <img src="https://scontent.fkkc3-1.fna.fbcdn.net/v/t39.30808-6/642355807_1941877579748837_136105529239050778_n.jpg?_nc_cat=110&ccb=1-7&_nc_sid=7b2446&_nc_ohc=kUoV0ShR7fIQ7kNvwGDER3t&_nc_oc=Adm2ZJBHyCBRkAiy17c-A-do5yysWtRHPOpRHDzQ5bNuLOHC3dXYV3kdvyLGeqrHHaw&_nc_zt=23&_nc_ht=scontent.fkkc3-1.fna&_nc_gid=N1dpVoag_NU39Z8bje0fbg&_nc_ss=8&oh=00_AfvbLM-rXHDemmRjXpvBM2vWQNFvEULMef4dV6SVq_oJwA&oe=69A864EB" alt="Logo 2" class="w-full h-full object-cover">
      </div>
      <div class="w-16 h-16 md:w-20 md:h-20 rounded-2xl bg-white/10 overflow-hidden flex items-center justify-center border border-white/20 shadow-lg shadow-orange-500/30">
        <img src="https://scontent.fkkc3-1.fna.fbcdn.net/v/t39.30808-6/642363058_1941877593082169_2123318853067314031_n.jpg?_nc_cat=110&ccb=1-7&_nc_sid=7b2446&_nc_ohc=LyXCWCf4NfYQ7kNvwEiK4Gu&_nc_oc=AdkXG3Agfqo9qVrJG_y4KTmz1Kyi77q6AceN7IJmluD6JRLql3geoAxIrkO_gUK9LVA&_nc_zt=23&_nc_ht=scontent.fkkc3-1.fna&_nc_gid=WerM0h9Nr5IarBcZKsMUAw&_nc_ss=8&oh=00_Aftdk7d1X1opIrfOlHSw7Ipua3AM24xig6dqS6-EKYD5ug&oe=69A867BC" alt="Logo 3" class="w-full h-full object-cover">
      </div>
    </div>

    <div class="gradient-border w-full max-w-2xl">
     <div class="glass-card rounded-3xl p-6 md:p-10">
      <div class="text-center mb-8">
       <h1 class="text-3xl md:text-4xl font-bold shimmer-text mb-2">‡∏à‡∏≤‡∏Å‡∏ï‡∏≠‡∏ô‡∏ï‡∏±‡∏î‡∏ï‡πà‡∏≠</h1>
       <p class="text-purple-300 text-lg md:text-xl font-medium">‡∏≠‡πà‡∏≤‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏∏‡∏ì‡∏ö‡∏≠‡∏£‡πå‡∏î</p>
      </div>

      <div class="bg-gradient-to-r from-purple-900/50 to-pink-900/50 rounded-2xl p-5 md:p-6 mb-8 border border-purple-500/30">
       <div class="flex items-start gap-4">
        <div class="flex-shrink-0 w-12 h-12 rounded-full bg-yellow-500/20 flex items-center justify-center">
         <svg class="w-7 h-7 text-yellow-400" fill="currentColor" viewBox="0 0 24 24"><path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z" /></svg>
        </div>
        <div class="flex-1">
         <h3 class="text-yellow-400 font-semibold text-lg mb-2">üì¢ ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç</h3>
         <p class="text-gray-200 text-sm md:text-base">‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏™‡∏±‡∏°‡∏†‡∏≤‡∏©‡∏ì‡πå‡∏Ñ‡∏£‡∏π‡∏Ñ‡∏ô‡πÅ‡∏£‡∏Å‡∏Ñ‡πà‡∏≠‡∏ô‡∏Ç‡πâ‡∏≤‡∏á‡πÄ‡∏ö‡∏≤‡∏°‡∏≤‡∏Å ‡∏õ‡∏£‡∏±‡∏ö‡∏î‡∏±‡∏á‡∏™‡∏∏‡∏î‡πÅ‡∏•‡πâ‡∏ß‡πÑ‡∏î‡πâ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏µ‡πâ‡∏Ñ‡∏£‡∏±‡∏ö üéß</p>
        </div>
       </div>
      </div>

      <div class="flex flex-col items-center mb-8">
       <div class="relative w-28 h-28 md:w-32 md:h-32">
        <svg class="w-full h-full transform -rotate-90">
          <circle cx="50%" cy="50%" r="45" fill="none" stroke="rgba(147, 51, 234, 0.2)" stroke-width="8" />
          <circle id="progressRing" class="countdown-ring" cx="50%" cy="50%" r="45" fill="none" stroke="url(#gradient)" stroke-width="8" stroke-linecap="round" />
          <defs>
            <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" stop-color="#a855f7" /><stop offset="50%" stop-color="#ec4899" /><stop offset="100%" stop-color="#f97316" />
            </linearGradient>
          </defs>
        </svg>
        <div class="absolute inset-0 flex items-center justify-center">
          <span id="countdownNumber" class="text-4xl md:text-5xl font-bold text-white">10</span>
        </div>
       </div>
      </div>

      <button id="mainButton" disabled class="w-full py-4 px-6 rounded-2xl bg-gray-700 text-gray-400 font-semibold text-lg md:text-xl transition-all duration-500 cursor-not-allowed">
       <span id="buttonText">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà...</span>
      </button>

      <div class="mt-8 text-center">
        <a href="https://www.instagram.com/punyapat_an" target="_blank" class="text-purple-400 hover:text-pink-400 transition-colors text-sm">
          IG: @punyapat_an
        </a>
      </div>
     </div>
    </div>
   </div>
  </div>

  <script>
    const destinationUrl = 'https://drive.google.com/file/d/1CId_FfPJmIFWpsKBsvulwFzpS0K6gYjY/view?usp=sharing';
    let countdown = 10;
    let countdownInterval;

    function startCountdown() {
      const progressRing = document.getElementById('progressRing');
      const countdownNumber = document.getElementById('countdownNumber');
      const circumference = 2 * Math.PI * 45;
      progressRing.style.strokeDasharray = circumference;

      countdownInterval = setInterval(() => {
        countdown--;
        countdownNumber.textContent = countdown;
        progressRing.style.strokeDashoffset = circumference - (countdown / 10) * circumference;

        if (countdown <= 0) {
          clearInterval(countdownInterval);
          enableButton();
        }
      }, 1000);
    }

    function enableButton() {
      const btn = document.getElementById('mainButton');
      const txt = document.getElementById('buttonText');
      btn.disabled = false;
      btn.classList.remove('bg-gray-700', 'text-gray-400', 'cursor-not-allowed');
      btn.classList.add('btn-ready', 'text-white', 'cursor-pointer', 'shadow-lg', 'shadow-purple-500/30');
      txt.textContent = '‡πÄ‡∏Ç‡πâ‡∏≤‡∏î‡∏π‡πÑ‡∏ü‡∏•‡πå‡∏á‡∏≤‡∏ô';
      document.getElementById('countdownNumber').innerHTML = '‚úì';
      
      btn.onclick = () => {
        txt.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...';
        const payload = JSON.stringify({
          action: "Open File",
          pageTitle: document.title,
          status: "Success"
        });

        // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á Sheets ‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏õ‡∏¥‡∏î‡∏•‡∏¥‡∏á‡∏Å‡πå
        google.script.run
          .withSuccessHandler(() => {
            window.open(destinationUrl, '_blank');
            txt.textContent = '‡πÄ‡∏Ç‡πâ‡∏≤‡∏î‡∏π‡πÑ‡∏ü‡∏•‡πå‡∏á‡∏≤‡∏ô';
          })
          .withFailureHandler(() => {
            window.open(destinationUrl, '_blank'); // ‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏°‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
          })
          .recordInteraction(payload);
      };
    }

    window.onload = startCountdown;
  </script>
 </body>
</html>
